language: golang
sudo: required
services:
  - docker


before_install:
  - docker-compose build

script:
  - echo "running tests"
  - docker-compose run --rm web go test

after_success:
  - docker login -u $DOCKER_USERNAME --password-stdin $DOCKER_PASSWORD
  - docker-compose push